#!/bin/bash

function connect {
    rm -f /tmp/gc-docker.sock
    echo 'Redirected builder:/var/run/docker.sock to /tmp/gc-docker.sock'
    ssh -N -p 22 -c aes256-ctr root@builder-2 -L /tmp/gc-docker.sock:/var/run/docker.sock
}

if [ -S /tmp/gc-docker.sock ]; then
    echo "Already connected, use 'w gc'"
else
    connect
    rm -f /tmp/gc-docker.sock && echo 'Deleted /tmp/gc-docker.sock'
fi
